export { default as theme } from './src'
import { Appear,Head, Image } from 'mdx-deck'
import { Layout, LayoutNoFooter, CodeSanbox, Split, BGImage } from './src'
import { CodeSurfer } from 'mdx-deck-code-surfer'
import nightOwl from 'prism-react-renderer/themes/nightOwl'

<Head>
  <title>PWA for designers</title>
</Head>

<BGImage src={require('file-loader!./images/space_scene-min.jpg')} />

# Progressive Web Applications

---

export default Layout

# What is a PWA?

### Progressive Web Apps are user experiences that have the reach of the web, and are:

<Appear>
  <p>
    Reliable - Load instantly and never show the downasaur, even in uncertain
    network conditions.
  </p>
  <p>
    Fast - Respond quickly to user interactions with silky smooth animations and
    no janky scrolling.
  </p>
  <p>
    Engaging - Feel like a natural app on the device, with an immersive user
    experience.
  </p>
  <p>
    This new level of quality allows Progressive Web Apps to earn a place on the
    user's home screen.
  </p>
</Appear>

---

export default Layout

# pwa design

<Appear>

<p>
  Design for touch: as a native application
</p>
<p>
  It’s good practice to use standard device fonts to make the PWA appear native and familiar
</p>
<p>
  Design for offline first
</p>
<p>
  Homescreen icon
</p>

<https://hasura.io/blog/design-guide-to-offline-first-apps/>

</Appear>

---

export default Layout

# pwa vs native


<Appear>

 <p>
   No IOS, android, or hybrid app developers required
  </p>

  <p>
    Any page or screen on your PWA can have its own shareable direct link
  </p>

  <p>
    Content in PWAs can be easily found by search engines and are adjusted to Google’s mobile-first index
  </p>

</Appear>

---


export default Layout

# an open web

  <p>
  pwa keeps the spirit of the open web alive
  </p>

  <p>
    No walled garden, Apple App Store validation rules,
  </p>

---

export default Layout

# Development

---

export default Layout

# App shell

<Appear>
<p>
  The App shell concept is concerned with loading a minimal user interface as soon as possible and then caching it so it is available
  The next time someone visits the app from the device.
</p>

<p>
  The UI loads from the cache immediately and any new content is requested from the server
  (if it isn’t available in the cache already).
</p>

<https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps/Structural_overview>

</Appear>

```notes

```

---

export default Layout

# app manifest

<Appear>

<p>
  The web app manifest is a JSON file that tells the browser about your web application and how it should behave when 'installed'
  on the user's mobile device or desktop.
</p>

<p>
  Having a manifest is required by Chrome to show the Add to Home Screen prompt.
</p>

<p>
  The web app manifest is a JSON file that tells the browser about your web application and how it should behave when 'installed' on the user's mobile device or desktop.
  Having a manifest is required by Chrome to show the Add to Home Screen prompt."
</p>

<https://developer.mozilla.org/en-US/docs/Web/Manifest>

</Appear>

```notes

```

---

export default LayoutNoFooter

<CodeSurfer
  title="APP MANIFEST"
  code={require("!raw-loader!./examples/manifest.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    { range: [1, 3], notes: "Defines the PWA name" },
    { range: [10, 14], notes: "Homescreen icon " },
    { range: [29, 30], notes: "default colour" },
    {
      lines: [27],
      notes:
        "Defines the developers’ preferred display mode for the website."
    }
  ]}
/>

---

export default Split

<img src={require('file-loader!./images/browser.jpg')} />


- ### Browser
- The application opens in a conventional browser tab or new window,
- depending on the browser and platform.
- _This is the default._

---

export default Split

<img src={require('file-loader!./images/fullscreen.jpg')} />


- ### Fullscreen
- All of the available display area is used
- _no user agent chrome is shown_

---

export default Split

<img src={require('file-loader!./images/standalone.jpg')} />


- ### Standalone
- The application will look and feel like a standalone application.

- This can include the application having a different window,
- its own icon in the application launcher, etc.
- In this mode, the user agent will exclude UI elements for controlling navigation,
- but can include other UI elements such as a status bar.

---


export default Layout

#  Meta data for non android browsers


```notes
IOS and Microsoft Edge and still need some metadata to make the app installable.
For iOS, it needs three `<meta>` tags.
They all start with apple-mobile-web-app and have a content property.````

---

export default LayoutNoFooter

<CodeSurfer
  title="META DATA"
  notes="Android does most of this by default"
  code={require("!raw-loader!./examples/meta.html")}
  lang="html"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
/>

```notes
- Create speaker notes in fenced code blocks
```

---

export default Layout


# Homescreen icon

The icon that will be displayed in the iOS home screen. We will do this with a `<link>` tag.


---

export default Layout

# Capable

This meta tag tells iOS that this web app is installable.

---

export default Layout

# Status bar

Configure the status-bar-style, which it can be default, which is just the user's status bar.

IOS - default, black, black-translucent


---

export default Layout

# Service workers

A service worker is a script that runs in the background without access to the UI, and a requisite for a Progressive Web App.
They can be used for caching requests and assets.


---

export default Layout

# More service workers

- Service Workers are a virtual proxy between the browser and the network.
- They run on a separate thread from the main JavaScript code of the page, and don't have any access to the DOM structure.
- Non blocking API
- You are able to give a Service Worker something to work on, and receive the result whenever it is ready using a Promise-based approach.

---

export default Layout

# Service workers life cycle

<Appear>
  <p>Parsed</p>
  <p>Installed</p>
  <p>Activating</p>
  <p>Activated</p>
  <p>Redundant</p>
</Appear>

```notes
- Create speaker notes in fenced code blocks
```



---
export default LayoutNoFooter

<CodeSurfer
  title="Service worker example"
  code={require("!raw-loader!./examples/serviceworker.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    {
      lines: [1],
      notes:
        "Registering a service worker, Browsers that support Service Worker expose service worker on the global navigator object."
    },
    {
      range: [3, 11],
      notes:
        "Check if the browser supports service workers, if the navigator object has a serviceWorker property"
    }
  ]}
/>

---

export default Layout

# Installed

Once the Service Worker script has been parsed,

the user agent attempts to install it and it moves to the installing state.

---

export default Layout

# Activating

The activating state will be triggered for a waiting Service Worker in one of the following scenarios -

If there is no current active worker already

If the `self.skipWaiting()` method is called in the Service Worker script

If the user has navigated away from the page, thereby releasing the previous active worker

If a specified period of time has passed, thereby releasing the previous active worker

---

export default Layout

# Activated

If activation is successful, the Service Worker moves to the active state.

In this state, it is an active worker in full control of the document.

---

export default Layout

# Redundant

A Service Worker can become redundant for one of the following reasons -

If the installing event failed

If the activating event failed

If a new Service Worker replaces it as the active service worker

---

export default Layout

# Service workers scope

- The service worker will only catch requests from clients under the service worker's scope.
- The max scope for a service worker is the location of the worker.
- If your server worker is active on a client being served with the Service-Worker-Allowed header,
  you can specify a list of max scopes for that worker.
- In Firefox, Service Worker APIs are hidden and cannot be used when the user is in private browsing mode.

```notes
- Create speaker notes in fenced code blocks
```



---


<Image src={require("!file-loader!./images/scope.png")} size="contain" />

---

export default Layout

# Network Strategy

With network strategies, you can tune which types of requests should
get the freshest content possible and which should try to get responses
from cache. That helps improve online performance by avoiding
unnecessary network round trips for static assets.

```notes
- Create speaker notes in fenced code blocks
```

---

export default LayoutNoFooter

<CodeSurfer
  title="fetch from cache"
  code={require("!raw-loader!./examples/serviceworker.2.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
/>

---

export default Layout

# Precache

Service Worker Precache is a module for generating a service worker that precaches resources.

It integrates with your build process. Once configured, it detects all your static resources
(HTML, JavaScript, CSS, images, etc.) and generates a hash of each file's contents.

Information about each file's URL and versioned hash are stored in the generated service worker file,
along with logic to serve those files cache-first and automatically keep those files up to date when changes are detected in subsequent builds.


<https://github.com/GoogleChromeLabs/sw-precache>

<https://www.npmjs.com/package/sw-precache>

---
export default LayoutNoFooter

<CodeSurfer
  title=" Service Worker Precache "
  notes="Service Worker Precache is a module for generating a service worker that precaches resources. ✏️"
  code={require("!raw-loader!./examples/webpack-precache.js")}
  lang="javascript"
  showNumbers={true}
  theme={nightOwl}
  dark={false}
  steps={[
    {
      range: [22, 29],
      notes:
        " URL Patterns for caching images from the cat API - images can be viewed offline ✏️"
    }
  ]}
/>

```notes
- Create speaker notes in fenced code blocks
```

---

export default Layout

# Navigator API - Check online status

Returns the online status of the browser. The property returns a boolean value, with true meaning online and false meaning offline.

---

export default Layout

# More Navigator

The property sends updates whenever the browser's ability to connect to the network changes. The update occurs when the user follows links or when a script requests a remote page.

For example, the property should return false when users click links soon after they lose internet connection.

---

export default Layout

# Using the Navigator

**USE CASE** - navigator offline API for disabling button state for form post

<https://caniuse.com/#feat=online-status>

```notes
- Create speaker notes in fenced code blocks
```

---

export default Layout

# Push Notifications

native application like push notifications

A notification is a message that pops up on the user's device. Notifications can be triggered locally by an open application,
or they can be "pushed" from the server to the user even when the app is not running.

**USE CASE** - fresh content alert, offline warning alert

<https://developers.google.com/web/ilt/pwa/introduction-to-push-notifications>

```notes
- Create speaker notes in fenced code blocks
```

---

export default Layout

# Performance 🏃💨

<https://hnpwa.com/>

```notes
- Create speaker notes in fenced code blocks
```



---

export default Layout

# Lighthouse audits

Lighthouse is an open-source, automated tool for improving the quality of web pages.

You can run it against any web page, public or requiring authentication.
It has audits for performance, accessibility, progressive web apps, and more.

---

<Image src={require("!file-loader!./images/lighthouse.jpg")} size="contain" />

---

export default Layout

# Development Env.

Mobile testing - Ngrok is a service that relays your local environment on an external dns,

`npm install -g ngrok`

run

`ngrok http 8080`

browse to the external URL

---

export default Layout

# Test Production

service workers are a production feature so....

emulate an HTTP server `sudo npm install -g serve`

build project `npm run build`

serve production files `serve dist`


---

<Image src={require("!file-loader!./images/win.gif")} size="contain" />

---

<Image src={require("!file-loader!./images/pwa-stats.png")} size="contain" />

---


export default Split

<img src={require('file-loader!./images/businesstime.gif')} />


- <https://www.pwastats.com>
-
- <https://smashingideas.com/pwa-statistics>

---

export default LayoutNoFooter


<BGImage src={require('file-loader!./images/cat.jpg')} />

# gifs and cats

<https://pwa-chat-2a5f9.firebaseapp.com>

```notes
- Create speaker notes in fenced code blocks
```

---

export default Layout

# useful links

<https://caniuse.com/#feat=serviceworkers>

<https://developers.google.com/web/progressive-web-apps>

<https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API>

<https://serviceworke.rs/>

<https://egghead.io/courses/offline-first-progressive-web-apps-pwa-in-vue-js>

<https://www.smashingmagazine.com/2018/09/smashing-book-6-release>

```notes
- Create speaker notes in fenced code blocks
```

---

export default Layout

# ...more useful links

<https://developers.google.com/web/tools/lighthouse>

<https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API>

<https://www.pwastats.com>

<https://pwa.rocks>

<https://hnpwa.com>

```notes
- Create speaker notes in fenced code blocks
```

---

export default Layout

# slides built with mdx-deck ⚛

# & codesurfer

## hosted on netlify

<https://github.com/jxnblk/mdx-deck>

<https://github.com/pomber/code-surfer>

<https://github.com/alanpcurrie/pwa-presentation>

<https://www.netlify.com>



```notes
- Create speaker notes in fenced code blocks
```

---

export default Layout

 # image credit

 <https://www.jpl.nasa.gov/visions-of-the-future>

 <https://www.flickr.com/photos/projectapolloarchive>


---


export default LayoutNoFooter

<BGImage src={require('file-loader!./images/moon.jpg')} />

# Thank You
